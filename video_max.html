<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Список видео с YouTube</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="images/istockphoto-626708040-612x612.jpg">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 10px;
            background-color: #f7f7f7;
        }

        .content-section {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            padding: 20px;
        }

        .content-section h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .video-links {
            list-style-type: disc;
            padding-left: 10px;
        }

        .video-item {
            margin: 0;
        }

        .video-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: #333;
            transition: background-color 0.3s;
            padding: 1px;
            border-radius: 4px;
            flex-wrap: wrap;
        }

        .video-link .video-index {
            color: #007bff;
            margin-right: 10px;
        }

        .content-section .video-avatar {
            width: 100px;
            height: auto;
        }

        .video-link img {
            width: 50px;
            height: auto;
        }

        .video-player {
            display: none;
            border-radius: 8px;
            overflow: hidden;
        }

        .submenu {
            display: none;
        }

        input[type="checkbox"] {
            display: none;
        }

        label[for="services-toggle"],
        label[for="preachers-toggle"] {
            position: relative;
        }

        label[for="services-toggle"]:after,
        label[for="preachers-toggle"]:after {
            content: "▼";
            position: absolute;
            right: -20px;
        }

        input[type="checkbox"]:checked + .submenu {
            display: block;
        }

        @media (max-width: 768px) {
            .video-player {
                position: relative;
                padding-bottom: 56.25%;
                height: 0;
                width: 100%;
            }

            .video-player iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }

            .video-link .video-title {
                font-size: 14px;
            }

            .content-section img {
                width: 20px;
                height: 20px;
            }
        }

        nav ul li {
            margin-bottom: 0px;
        }

        nav ul li a {
            text-decoration: none;
            color: #555;
            width: 250px;
            display: block;
            padding: 4px 10px;
            background-color: #f5f5f5;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            font-size: 20px;
        }

        nav ul li a:hover {
            background-color: #ddd;
        }

        @media (min-width: 769px) {
            .video-player {
                width: 560px;
                height: 315px;
            }

            .content-section img {
                width: 20px;
                height: 20px;
            }
        }
    </style>
</head>
<body>    


    <footer style="text-align: center; margin-top: 20px;">
        <p>&copy; 2024 Церква "Дім Євангелія"</p>
    </footer>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const loader = document.getElementById('loader');
            const videoLinksContainers = document.querySelectorAll('.video-links');
            const videoPlayers = document.querySelectorAll('.video-player');

            // Загрузка списка видео из файла
            loader.style.display = 'block';  // Показать индикатор загрузки
            fetch('https://raw.githubusercontent.com/ruyriy/VideoYouTube/main/youtube_videos_list.txt')
                .then(response => response.text())
                .then(data => {
                    const videos = data.trim().split('\n');
                    processVideos(videos);
                    loader.style.display = 'none';  // Скрыть индикатор загрузки после завершения
                })
                .catch(error => {
                    console.error('Ошибка загрузки видео:', error);
                    loader.style.display = 'none';  // Скрыть индикатор загрузки в случае ошибки
                });

            function processVideos(videos) {
                const videoGroups = {};
                const unknownVideos = [];

                videos.forEach(video => {
                    const [videoIndex, group, videoId, videoTitle] = video.split('§');
                    if (!videoGroups[group]) {
                        videoGroups[group] = [];
                    }
                    videoGroups[group].push({ videoIndex, videoId, videoTitle });
                });

                const totalVideoCount = videos.length;
                document.getElementById('totalVideoCount').textContent = totalVideoCount;

                videoLinksContainers.forEach(container => {
                    const groupNames = container.getAttribute('data-group').split('|');
                    const videosForGroup = groupNames.flatMap(group => videoGroups[group] || []);

                    renderVideoList(videosForGroup, container);

                    groupNames.forEach(group => {
                        delete videoGroups[group];
                    });
                });

                Object.values(videoGroups).forEach(groupVideos => {
                    unknownVideos.push(...groupVideos);
                });

                const unknownGroupContainer = document.querySelector('.video-links[data-group="unknown"]');
                renderVideoList(unknownVideos, unknownGroupContainer);
            }

            function renderVideoList(videos, container) {
                videos.forEach(({ videoIndex, videoId, videoTitle }) => {
                    const videoItem = createVideoItem(videoIndex, videoId, videoTitle);
                    container.appendChild(videoItem);
                });

                updateVideoListeners(container);
            }

            function createVideoItem(videoIndex, videoId, videoTitle) {
                const videoItem = document.createElement('li');
                videoItem.className = 'video-item';
                videoItem.setAttribute('data-video-id', videoId);

                const videoLink = document.createElement('a');
                videoLink.className = 'video-link';
                videoLink.href = '#';

                const videoImage = document.createElement('img');
                videoImage.src = 'images/youtube_icon.png';
                videoImage.alt = 'YouTube Icon';

                const videoIndexSpan = document.createElement('span');
                videoIndexSpan.className = 'video-index';
                videoIndexSpan.textContent = `[${videoIndex}] Видео `;

                const videoTitleSpan = document.createElement('span');
                videoTitleSpan.className = 'video-title';
                videoTitleSpan.textContent = videoTitle;

                videoLink.appendChild(videoImage);
                videoLink.appendChild(videoIndexSpan);
                videoLink.appendChild(videoTitleSpan);

                const videoPlayerDiv = document.createElement('div');
                videoPlayerDiv.className = 'video-player';

                videoItem.appendChild(videoLink);
                videoItem.appendChild(videoPlayerDiv);

                return videoItem;
            }

            function updateVideoListeners(container) {
                const videoLinks = container.querySelectorAll('.video-link');
                const videoPlayers = container.querySelectorAll('.video-player');

                videoLinks.forEach((link, index) => {
                    link.addEventListener('click', function(event) {
                        event.preventDefault();
                        const parentItem = this.parentElement;
                        const videoId = parentItem.getAttribute('data-video-id');

                        videoPlayers.forEach(player => {
                            player.style.display = 'none';
                            player.innerHTML = '';
                        });

                        const playerDiv = parentItem.querySelector('.video-player');
                        const iframe = document.createElement('iframe');
                        iframe.setAttribute('width', '560');
                        iframe.setAttribute('height', '315');
                        iframe.setAttribute('src', `https://www.youtube.com/embed/${videoId}`);
                        iframe.setAttribute('frameborder', '0');
                        iframe.setAttribute('allowfullscreen', 'true');

                        playerDiv.appendChild(iframe);
                        playerDiv.style.display = 'block';
                    });
                });
            }
        });
    </script>
</body>
</html>

